Running training with original data
Simulated graph file doesn't exist, generating file...
Args in experiment:
Namespace(activation='gelu', attn='prob', batch_size=32, c_out=90, checkpoints='./checkpoints/', cols=None, d_ff=2048, d_layers=1, d_model=512, data='sim_graph', data_path='g_n10_t1000.csv', dec_in=90, des='g_n10_t1000_test', detail_freq='d', device_ids=[0, 1, 2, 3], devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', enc_in=90, factor=5, features='M', freq='d', gpu=0, inverse=False, itr=2, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', m_true_len=90, mix=True, model='informer', n_heads=8, num_workers=0, output_attention=False, padding=0, patience=3, pred_len=24, root_path='./data/', s_layers=[3, 2, 1], seq_len=96, target='none', train_epochs=6, use_amp=False, use_gpu=True, use_multi_gpu=True)
Use GPU: cuda:0
>>>>>>>start training : informer_sim_graph_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_atprob_fc5_ebtimeF_dtTrue_mxTrue_g_n10_t1000_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
features M
train 581
features M
val 77
features M
test 177
Epoch: 1 cost time: 6.549986839294434
Epoch: 1, Steps: 18 | Train Loss: 0.4607683 Vali Loss: 0.3728885 Test Loss: 0.3728647
Validation loss decreased (inf --> 0.372888).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.6704037189483643
Epoch: 2, Steps: 18 | Train Loss: 0.3363403 Vali Loss: 0.2610679 Test Loss: 0.2661928
Validation loss decreased (0.372888 --> 0.261068).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.5578618049621582
Epoch: 3, Steps: 18 | Train Loss: 0.2515055 Vali Loss: 0.2216118 Test Loss: 0.2180814
Validation loss decreased (0.261068 --> 0.221612).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.776559829711914
Epoch: 4, Steps: 18 | Train Loss: 0.2264229 Vali Loss: 0.1958135 Test Loss: 0.2009619
Validation loss decreased (0.221612 --> 0.195814).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.564929723739624
Epoch: 5, Steps: 18 | Train Loss: 0.2175653 Vali Loss: 0.2004611 Test Loss: 0.1999302
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
Epoch: 6 cost time: 1.8373451232910156
Epoch: 6, Steps: 18 | Train Loss: 0.2163611 Vali Loss: 0.1980833 Test Loss: 0.1955421
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
>>>>>>>testing : informer_sim_graph_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_atprob_fc5_ebtimeF_dtTrue_mxTrue_g_n10_t1000_test_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
features M
test 177
test shape: (5, 32, 24, 90) (5, 32, 24, 90)
test shape: (160, 24, 90) (160, 24, 90)
mse:0.20020057260990143, mae:0.2568395137786865
Use GPU: cuda:0
>>>>>>>start training : informer_sim_graph_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_atprob_fc5_ebtimeF_dtTrue_mxTrue_g_n10_t1000_test_1>>>>>>>>>>>>>>>>>>>>>>>>>>
features M
train 581
features M
val 77
features M
test 177
Epoch: 1 cost time: 1.5700318813323975
Epoch: 1, Steps: 18 | Train Loss: 0.4532125 Vali Loss: 0.3546852 Test Loss: 0.3550860
Validation loss decreased (inf --> 0.354685).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 1.720489501953125
Epoch: 2, Steps: 18 | Train Loss: 0.3358262 Vali Loss: 0.2961672 Test Loss: 0.2959023
Validation loss decreased (0.354685 --> 0.296167).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3 cost time: 1.7435510158538818
Epoch: 3, Steps: 18 | Train Loss: 0.2878291 Vali Loss: 0.2627802 Test Loss: 0.2597112
Validation loss decreased (0.296167 --> 0.262780).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4 cost time: 1.712019681930542
Epoch: 4, Steps: 18 | Train Loss: 0.2659404 Vali Loss: 0.2419382 Test Loss: 0.2451262
Validation loss decreased (0.262780 --> 0.241938).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5 cost time: 1.7135448455810547
Epoch: 5, Steps: 18 | Train Loss: 0.2565810 Vali Loss: 0.2408129 Test Loss: 0.2448052
Validation loss decreased (0.241938 --> 0.240813).  Saving model ...
Updating learning rate to 6.25e-06
Epoch: 6 cost time: 1.7103707790374756
Epoch: 6, Steps: 18 | Train Loss: 0.2543770 Vali Loss: 0.2335570 Test Loss: 0.2438620
Validation loss decreased (0.240813 --> 0.233557).  Saving model ...
Updating learning rate to 3.125e-06
>>>>>>>testing : informer_sim_graph_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_atprob_fc5_ebtimeF_dtTrue_mxTrue_g_n10_t1000_test_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
features M
test 177
test shape: (5, 32, 24, 90) (5, 32, 24, 90)
test shape: (160, 24, 90) (160, 24, 90)
mse:0.2379111349582672, mae:0.27720874547958374
