Args in experiment:
Namespace(activation='gelu', attn='prob', batch_size=32, c_out=90, checkpoints='./checkpoints/', cols=None, d_ff=2048, d_layers=10, d_model=512, data='custom', data_path='sim_graph.csv', dec_in=90, des='simulated_graph_informer_test', detail_freq='d', device_ids=[0, 1, 2, 3], devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=10, embed='timeF', enc_in=90, factor=5, features='M', freq='d', gpu=0, inverse=False, itr=2, label_len=48, learning_rate=0.0001, loss='mse', lradj='type1', mix=True, model='informer', n_heads=8, num_workers=8, output_attention=False, padding=0, patience=5, pred_len=24, root_path='./data/', s_layers=[3, 2, 1], seq_len=96, target='none', train_epochs=20, use_amp=False, use_gpu=True, use_multi_gpu=True)
Use GPU: cuda:0
>>>>>>>start training : informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el10_dl10_df2048_atprob_fc5_ebtimeF_dtTrue_mxTrue_simulated_graph_informer_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
features M
train 581
features M
val 78
features M
test 177
Traceback (most recent call last):
  File "./main_informer.py", line 104, in <module>
    exp.train(setting)
  File "/home/isaacwp/Informer2020/exp/exp_informer.py", line 158, in train
    train_data, batch_x, batch_y, batch_x_mark, batch_y_mark)
  File "/home/isaacwp/Informer2020/exp/exp_informer.py", line 286, in _process_one_batch
    outputs = self.model(batch_x, batch_x_mark, dec_inp, batch_y_mark)
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py", line 167, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py", line 177, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py", line 86, in parallel_apply
    output.reraise()
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/_utils.py", line 429, in reraise
    raise self.exc_type(msg)
RuntimeError: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/isaacwp/Informer2020/models/model.py", line 70, in forward
    enc_out, attns = self.encoder(enc_out, attn_mask=enc_self_mask)
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/isaacwp/Informer2020/models/encoder.py", line 68, in forward
    x, attn = attn_layer(x, attn_mask=attn_mask)
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/isaacwp/Informer2020/models/encoder.py", line 46, in forward
    attn_mask = attn_mask
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/isaacwp/Informer2020/models/attn.py", line 157, in forward
    attn_mask
  File "/home/isaacwp/.conda/envs/informer/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/isaacwp/Informer2020/models/attn.py", line 114, in forward
    scores_top, index = self._prob_QK(queries, keys, sample_k=U_part, n_top=u)
  File "/home/isaacwp/Informer2020/models/attn.py", line 59, in _prob_QK
    M = Q_K_sample.max(-1)[0] - torch.div(Q_K_sample.sum(-1), L_K)
RuntimeError: cannot perform reduction function max on tensor with no elements because the operation does not have an identity

